{"ast":null,"code":"import'../App.css';import React,{useState}from'react';import Cookies from'js-cookie';//const authToken = Cookies.get('auth_token');\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const getUserIdFromToken=()=>{// Replace this with the correct method to retrieve user ID from the token/cookie\nconst token=Cookies.get('auth_token');if(!token){return null;// No token found\n}try{// Parse the token\nconst decodedToken=JSON.parse(atob(token.split('.')[1]));// Check if the token contains the user ID\nif(decodedToken&&decodedToken.userId){return decodedToken.userId;// Return the user ID\n}else{console.error('User ID not found in the token:',decodedToken);return null;// User ID not found in the token\n}}catch(e){console.error('Error decoding token:',e);return null;// Error decoding token\n}};// const parseJwt = (token) => {\n//   try {\n//     return JSON.parse(atob(token.split('.')[1]));\n//   } catch (e) {\n//     return null;\n//   }\n// };\nconst TicketForm=()=>{const[ticketData,setTicketData]=useState({user:getUserIdFromToken(),// Replace with the correct method to get user ID\nCategory:'',Sub_Category:'',TDescribtion:''});const[ticketMessage,setTicketMessage]=useState('');const handleChange=e=>{const{name,value}=e.target;setTicketData(prevData=>({...prevData,[name]:value}));};const handleTicketCreation=async e=>{e.preventDefault();try{// Get user ID from the token/cookie\nconst userId=getUserIdFromToken();// Replace with the correct method to get user ID\nconst response=await fetch('http://localhost:3000/Tickets/createTicket',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(Cookies.get('auth_token'))},credentials:'include',body:JSON.stringify({...ticketData,user:userId// Pass the user ID to the server\n})});if(response.ok){setTicketMessage('Ticket created successfully');}else{setTicketMessage('Choose a Category/sub Category');}}catch(error){console.error('Error:',error);setTicketMessage('An error occurred during the process of creating a ticket. Please try again.');}};const categoryOptions=['Hardware','Software','Network'];const Sub_CategoryOptions={Hardware:['Desktops','Laptops','Printers','Servers','Networking equipment'],Software:['Operating system','Application software','Custom software','Integration issues'],Network:['Email issues','Internet connection problems','Website errors']};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create a New Ticket\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleTicketCreation,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Category:\",/*#__PURE__*/_jsxs(\"select\",{name:\"Category\",value:ticketData.Category,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"Select a Category\"}),categoryOptions.map(Category=>/*#__PURE__*/_jsx(\"option\",{value:Category,children:Category},Category))]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Sub Category:\",/*#__PURE__*/_jsxs(\"select\",{name:\"Sub_Category\",value:ticketData.Sub_Category,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"Select a Sub Category\"}),ticketData.Category&&Sub_CategoryOptions[ticketData.Category].map(Sub_Category=>/*#__PURE__*/_jsx(\"option\",{value:Sub_Category,children:Sub_Category},Sub_Category))]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Description:\",/*#__PURE__*/_jsx(\"textarea\",{name:\"TDescribtion\",value:ticketData.TDescribtion,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Create Ticket\"})]}),ticketMessage&&/*#__PURE__*/_jsx(\"p\",{children:ticketMessage})]});};export default TicketForm;","map":{"version":3,"names":["React","useState","Cookies","jsx","_jsx","jsxs","_jsxs","getUserIdFromToken","token","get","decodedToken","JSON","parse","atob","split","userId","console","error","e","TicketForm","ticketData","setTicketData","user","Category","Sub_Category","TDescribtion","ticketMessage","setTicketMessage","handleChange","name","value","target","prevData","handleTicketCreation","preventDefault","response","fetch","method","headers","concat","credentials","body","stringify","ok","categoryOptions","Sub_CategoryOptions","Hardware","Software","Network","children","onSubmit","onChange","required","disabled","map","type"],"sources":["/Users/mazen/Help_Desk/frontend/my-react-app/src/components/createTicketComponent.js"],"sourcesContent":["import '../App.css';\nimport React, { useState } from 'react';\nimport Cookies from 'js-cookie';\n\n//const authToken = Cookies.get('auth_token');\n\nconst getUserIdFromToken = () => {\n  // Replace this with the correct method to retrieve user ID from the token/cookie\n  const token = Cookies.get('auth_token');\n  \n  if (!token) {\n    return null; // No token found\n  }\n\n  try {\n    // Parse the token\n    const decodedToken = JSON.parse(atob(token.split('.')[1]));\n\n    // Check if the token contains the user ID\n    if (decodedToken && decodedToken.userId) {\n      return decodedToken.userId; // Return the user ID\n    } else {\n      console.error('User ID not found in the token:', decodedToken);\n      return null; // User ID not found in the token\n    }\n  } catch (e) {\n    console.error('Error decoding token:', e);\n    return null; // Error decoding token\n  }\n};\n\n// const parseJwt = (token) => {\n//   try {\n//     return JSON.parse(atob(token.split('.')[1]));\n//   } catch (e) {\n//     return null;\n//   }\n// };\n\nconst TicketForm = () => {\n  const [ticketData, setTicketData] = useState({\n    user: getUserIdFromToken(), // Replace with the correct method to get user ID\n    Category: '',\n    Sub_Category: '',\n    TDescribtion: '',\n  });\n\n  const [ticketMessage, setTicketMessage] = useState('');\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setTicketData((prevData) => ({\n      ...prevData,\n      [name]: value,\n    }));\n  };\n\n  const handleTicketCreation = async (e) => {\n    e.preventDefault();\n\n    try {\n      // Get user ID from the token/cookie\n      const userId = getUserIdFromToken(); // Replace with the correct method to get user ID\n\n      const response = await fetch('http://localhost:3000/Tickets/createTicket', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${Cookies.get('auth_token')}`, \n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          ...ticketData,\n          user: userId, // Pass the user ID to the server\n        }),\n      });\n\n      if (response.ok) {\n        setTicketMessage('Ticket created successfully');\n      } else {\n        setTicketMessage('Choose a Category/sub Category');\n      }\n    } catch (error) {\n      console.error('Error:', error);\n      setTicketMessage('An error occurred during the process of creating a ticket. Please try again.');\n    }\n  };\n\n  \n\n  \n\n  const categoryOptions = ['Hardware', 'Software', 'Network'];\n  const Sub_CategoryOptions = {\n    Hardware: ['Desktops', 'Laptops', 'Printers', 'Servers', 'Networking equipment'],\n    Software: ['Operating system', 'Application software', 'Custom software', 'Integration issues'],\n    Network: ['Email issues', 'Internet connection problems', 'Website errors'],\n  };\n\n  return (\n    <div>\n      <h2>Create a New Ticket</h2>\n      <form onSubmit={handleTicketCreation}>\n        <label>\n          Category:\n          <select\n            name=\"Category\"\n            value={ticketData.Category}\n            onChange={handleChange}\n            required\n          >\n            <option value=\"\" disabled>Select a Category</option>\n            {categoryOptions.map((Category) => (\n              <option key={Category} value={Category}>\n                {Category}\n              </option>\n            ))}\n          </select>\n        </label>\n\n        <br />\n\n        <label>\n          Sub Category:\n          <select\n            name=\"Sub_Category\"\n            value={ticketData.Sub_Category}\n            onChange={handleChange}\n            required\n          >\n            <option value=\"\" disabled>Select a Sub Category</option>\n            {ticketData.Category &&\n              Sub_CategoryOptions[ticketData.Category].map((Sub_Category) => (\n                <option key={Sub_Category} value={Sub_Category}>\n                  {Sub_Category}\n                </option>\n              ))}\n          </select>\n        </label>\n\n        <br />\n\n        <label>\n          Description:\n          <textarea\n            name=\"TDescribtion\"\n            value={ticketData.TDescribtion}\n            onChange={handleChange}\n            required\n          />\n        </label>\n\n        <br />\n\n        <button type=\"submit\">Create Ticket</button>\n      </form>\n      {ticketMessage && <p>{ticketMessage}</p>}\n    </div>\n  );\n};\n\nexport default TicketForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}